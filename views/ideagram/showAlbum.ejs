<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head.ejs') %>
    <link rel="stylesheet" type="text/css" href="/styles/showAlbum.css">
    <link rel="stylesheet" type="text/css" href="/styles/comments.css">
</head>
<body>
    <%- include('../partials/navbar.ejs') %>
    </br>
    </br>
    <h1 id='username-top-right-corner'><%= currentUser.username %></h1>
    <div class="album-details-container">
        <h3><strong>Album Name : </strong><%=album.name%></h3>
        <h4><strong>Description : </strong><%=album.description%></h4>
        <h4><strong>Total Images : </strong><%=album.images.length%></h4>
        <div>
            <a class="btn" href="/<%=album.name%>/image/new" id="upload-btn">Add Image</a>
        </div>
    </div>
    </br>
    <%  let imageIndex =0;   %>
    <% album.images.forEach(image => { %>
    
    <div class="individual-image">
        <div class="image-container">
            <h4>Image <%=imageIndex+1 %></h4>
            <img class="image-show" src="<%=image.url%>">
            <h2 id="uploadedBy">Uploaded by <strong><%=image.uploadedBy%></strong></h2>
            <% if(currentUser.username === image.uploadedBy){ %>
                <form action="/:<%=album.name%>/image/<%=imageIndex%>?_method=DELETE" method="POST">
                    <div>
                        <button class="btn" id="delete-btn" type="submit">Delete Image</button>
                    </div>
                </form>
            <% } %>
        </div>
        <h2 id=comment-heading>
            Share a feedback or ask a question
        </h2>
        <div class="comments-container">
            <% image.comments.forEach(comment => { %>
                <div class="comment">
                    <h3><%=comment.commentedBy%></h3>
                    <h2><%=comment.comment%></h2>
                    <h3><%=comment.commentedAt%></h3>
                </div>
            <%}) %>
            <form action = '/comment/create' method = 'POST'>
                <div>
                    <input type='text' name='comment' placeholder="Share a feedback or a question" required>
                </div>
                <div class="create-comment">
                    <input type ="hidden" name="imageID" value="<%=imageIndex%>"/>
                    <input type ="hidden" name="albumName" value="<%=album.name%>"/>
                    <button type="submit" class="waves-effect waves-light btn-small" href="/download" id="comment-btn">
                        <i class="material-icons right">message</i>Add new comment</button>
                </div>
            </form>
            <% imageIndex++ %>
        </div>
    <%})%> 
    </div>
</body>
</html>